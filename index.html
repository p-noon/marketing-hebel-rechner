<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Szenario-Simulator</title>
<style>
body {
  font-family: -apple-system, BlinkMacSystemFont, "SF Pro Text", Roboto, sans-serif;
  background: #f4f4f6;
  padding: 20px;
}
.simulator {
  max-width: 950px;
  margin: 40px auto;
  background: #fff;
  border-radius: 24px;
  box-shadow: 0 8px 20px rgba(0,0,0,0.08);
  padding: 32px;
  color: #1c1c1e;
}
h2 {
  text-align: center;
  font-size: 1.8rem;
  margin-bottom: 6px;
}
.subtitle {
  text-align: center;
  color: #666;
  margin-bottom: 24px;
}
.input-grid {
  display: flex;
  gap: 24px;
  flex-wrap: wrap;
}
.column {
  flex: 1;
  min-width: 280px;
}
label {
  font-size: 0.9rem;
  color: #444;
  display: block;
  margin-bottom: 6px;
  margin-top: 12px;
}
input {
  padding: 10px;
  border: 1px solid #d2d2d7;
  border-radius: 10px;
  font-size: 1rem;
  background: #f9f9f9;
  width: 100%;
  box-sizing: border-box;
  transition: all 0.2s;
}
input:focus {
  outline: none;
  border-color: #0071e3;
  background: white;
  box-shadow: 0 0 0 2px rgba(0,113,227,0.1);
}
.button-main {
  margin-top: 30px;
  width: 100%;
  background: #0071e3;
  color: white;
  font-weight: 600;
  border: none;
  border-radius: 14px;
  padding: 14px;
  font-size: 1.1rem;
  cursor: pointer;
  transition: background 0.2s;
}
.button-main:hover {
  background: #0a84ff;
}
.results {
  margin-top: 30px;
  text-align: center;
  display: none;
}
.result-grid {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 14px;
}
.result-card {
  background: #f5f5f7;
  padding: 16px;
  border-radius: 16px;
}
.result-card.highlight {
  background: #e8f0fe;
  box-shadow: 0 0 0 2px #0071e3 inset;
}
.result-card h1 {
  margin: 6px 0;
  font-size: 1.8rem;
}
.slider-section {
  margin-top: 40px;
  padding-top: 20px;
  border-top: 1px solid #ddd;
}
.slider-container {
  margin: 20px 0;
}
input[type=range] {
  width: 100%;
}
footer {
  text-align: center;
  margin-top: 20px;
  font-size: 13px;
  color: #999;
}
footer a {
  color: #0071e3;
  text-decoration: none;
}
</style>
</head>
<body>

<div class="simulator">
  <h2>Szenario-Simulator</h2>
  <p class="subtitle">Simuliere, wie sich dein Gewinn verändert, wenn du Kassenzettel oder Conversion Rate anpasst.</p>

  <div class="input-grid">
    <div class="column">
      <h3>Grunddaten</h3>
      <label>Bruttoumsatz pro Bestellung (in €)</label>
      <input id="revenueGross" type="number" placeholder="z. B. 60" step="0.01" oninput="updateNet()">
      <label>Nettoumsatz (berechnet)</label>
      <input id="revenueNet" type="text" readonly style="background:#f0f0f0;">
      <label>Herstellungskosten pro Bestellung (in €)</label>
      <input id="productionCost" type="number" placeholder="z. B. 20" step="0.01">
      <label>Verpackung & Versand (in €)</label>
      <input id="shippingCost" type="number" placeholder="z. B. 5" step="0.01">
    </div>

    <div class="column">
      <h3>Szenario</h3>
      <label>Conversion Rate (in %)</label>
      <input id="conversionRate" type="number" placeholder="z. B. 2" step="0.1">
      <label>ROAS</label>
      <input id="roas" type="number" placeholder="z. B. 3" step="0.1">
      <label>Marketingbudget (in €)</label>
      <input id="budget" type="number" placeholder="z. B. 1000" step="1">
    </div>
  </div>

  <button class="button-main" onclick="calcScenario()">Berechnen</button>

  <div class="results" id="results">
    <div class="result-grid">
      <div class="result-card highlight">
        <p><strong>Umsatz gesamt</strong></p>
        <h1 id="totalRevenue">–</h1>
      </div>
      <div class="result-card">
        <p><strong>Gewinn gesamt</strong></p>
        <h1 id="totalProfit">–</h1>
      </div>
    </div>

    <div class="slider-section" id="sliderSection" style="display:none;">
      <h3>Szenario ändern</h3>

      <div class="slider-container">
        <label>Kassenzettel verändern (%): <span id="receiptChangeLabel">0%</span></label>
        <input type="range" id="receiptChange" min="-30" max="30" value="0" step="1" oninput="updateScenario()">
      </div>

      <div class="slider-container">
        <label>Conversion Rate verändern (%): <span id="crChangeLabel">0%</span></label>
        <input type="range" id="crChange" min="-30" max="30" value="0" step="1" oninput="updateScenario()">
      </div>

      <div class="result-grid">
        <div class="result-card highlight">
          <p><strong>Neuer Umsatz</strong></p>
          <h1 id="newRevenue">–</h1>
        </div>
        <div class="result-card">
          <p><strong>Neuer Gewinn</strong></p>
          <h1 id="newProfit">–</h1>
        </div>
      </div>
    </div>
  </div>

  <footer>
    Tool entwickelt von <a href="https://www.purple-noon.de" target="_blank">Purple Noon</a>
  </footer>
</div>

<script>
let base = {};

function formatNumber(num) {
  return num.toLocaleString('de-DE', { minimumFractionDigits: 2, maximumFractionDigits: 2 });
}

function updateNet() {
  const gross = +document.getElementById("revenueGross").value || 0;
  const net = gross / 1.19;
  document.getElementById("revenueNet").value = formatNumber(net) + " €";
}

function calcScenario() {
  const gross = +document.getElementById("revenueGross").value || 0;
  const net = gross / 1.19;
  const production = +document.getElementById("productionCost").value || 0;
  const shipping = +document.getElementById("shippingCost").value || 0;
  const cr = (+document.getElementById("conversionRate").value || 0) / 100;
  const roas = +document.getElementById("roas").value || 0;
  const budget = +document.getElementById("budget").value || 0;

  const totalRevenue = roas * budget;
  const avgOrders = totalRevenue / gross; // Anzahl Bestellungen
  const profitPerOrder = net - production - shipping;
  const totalProfit = totalRevenue / roas * (roas - 1) * (profitPerOrder / (gross / 1.19));

  base = { gross, net, production, shipping, cr, roas, budget, totalRevenue, totalProfit };

  document.getElementById("totalRevenue").innerText = formatNumber(totalRevenue) + " €";
  document.getElementById("totalProfit").innerText = formatNumber(totalProfit) + " €";

  document.getElementById("results").style.display = "block";
  document.getElementById("sliderSection").style.display = "block";
}

function updateScenario() {
  const receiptChange = +document.getElementById("receiptChange").value;
  const crChange = +document.getElementById("crChange").value;

  document.getElementById("receiptChangeLabel").innerText = receiptChange + "%";
  document.getElementById("crChangeLabel").innerText = crChange + "%";

  if (!base.gross) return;

  // Kassenzettel-Anpassung
  const newGross = base.gross * (1 + receiptChange / 100);
  const newNet = newGross / 1.19;
  const newProduction = base.production * (1 + receiptChange / 100);
  const newShipping = base.shipping;

  // Besucheranzahl aus Ist-CR berechnen
  const visitors = (base.totalRevenue / base.gross) / base.cr;
  const newCr = base.cr * (1 + crChange / 100);

  // Neuer Umsatz & Gewinn
  const newOrders = visitors * newCr;
  const newRevenue = newOrders * newGross;
  const profitPerOrder = newNet - newProduction - newShipping;
  const newProfit = newOrders * profitPerOrder - base.budget;

  document.getElementById("newRevenue").innerText = formatNumber(newRevenue) + " €";
  document.getElementById("newProfit").innerText = formatNumber(newProfit) + " €";
}
</script>

</body>
</html>
