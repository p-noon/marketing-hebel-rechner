<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Kampagnen-Ergebnisprognose</title>
<style>
body {
  font-family: -apple-system, BlinkMacSystemFont, "SF Pro Text", Roboto, sans-serif;
  background: #f4f4f6;
  padding: 20px;
}
.calculator {
  max-width: 950px;
  margin: 40px auto;
  background: #fff;
  border-radius: 24px;
  box-shadow: 0 8px 20px rgba(0,0,0,0.08);
  padding: 32px;
  color: #1c1c1e;
}
h2 { text-align: center; font-size: 1.8rem; margin-bottom: 6px; }
.subtitle { text-align: center; color: #666; margin-bottom: 24px; }
.input-grid { display: flex; gap: 24px; flex-wrap: wrap; }
.column { flex: 1; min-width: 280px; }
label { font-size: 0.9rem; color: #444; display: block; margin-bottom: 6px; margin-top: 12px; }
input { padding: 10px; border: 1px solid #d2d2d7; border-radius: 10px; font-size: 1rem; background: #f9f9f9; width: 100%; box-sizing: border-box; transition: all 0.2s; }
input:focus { outline: none; border-color: #0071e3; background: white; box-shadow: 0 0 0 2px rgba(0,113,227,0.1); }
.button-main { margin-top: 30px; width: 100%; background: #0071e3; color: white; font-weight: 600; border: none; border-radius: 14px; padding: 14px; font-size: 1.1rem; cursor: pointer; transition: background 0.2s; }
.button-main:hover { background: #0a84ff; }
.results { margin-top: 30px; text-align: center; display: none; }
.result-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 14px; }
.result-card { background: #f5f5f7; padding: 16px; border-radius: 16px; }
.result-card.highlight { background: #e8f0fe; box-shadow: 0 0 0 2px #0071e3 inset; }
.result-card h1 { margin: 6px 0; font-size: 1.8rem; }
.warning { color: #d70015; font-weight: 600; margin-top: 10px; }
footer { text-align: center; margin-top: 20px; font-size: 13px; color: #999; }
footer a { color: #0071e3; text-decoration: none; }
footer a:hover { text-decoration: underline; }

/* Overlay Styles */
.overlay{
  position:fixed;
  top:0; left:0;
  width:100%; height:100%;
  background:rgba(0,0,0,0.5);
  display:none;
  justify-content:center;
  align-items:center;
  z-index:999;
  padding:20px;
  box-sizing:border-box;
  overflow:auto;
}
.overlay-content{
  background:#fff;
  padding:24px;
  border-radius:16px;
  width:100%;
  max-width:600px;
  max-height:90vh;
  box-shadow:0 10px 30px rgba(0,0,0,0.2);
  overflow:auto;
  box-sizing:border-box;
}
.overlay-content textarea{
  width:100%;
  height:120px;
  font-family:monospace;
  border-radius:8px;
  border:1px solid #ccc;
  padding:8px;
  box-sizing:border-box;
}
.close-btn{
  background:#0071e3;
  color:white;
  border:none;
  padding:8px 16px;
  border-radius:8px;
  margin-top:12px;
  cursor:pointer;
}

/* âœ… Mobile Fix */
@media (max-width: 600px) {
  .result-grid {
    display: flex;
    flex-direction: column;
    align-items: center;   /* Zentriert die Kacheln */
    gap: 10px;
  }
  .result-card {
    width: 90%;            /* gleichmÃ¤ÃŸiger Abstand links/rechts */
    max-width: 400px;
  }
}
</style>
</head>
<body>

<div class="calculator">
  <h2>Kampagnen-Ergebnisprognose</h2>
  <p class="subtitle">Berechne, wie viel Gewinn oder Verlust deine Kampagne bei gegebenem Marketingbudget erzielt.</p>

  <div class="input-grid">
    <div class="column">
      <h3>Grunddaten</h3>
      <label>Bruttoumsatz pro Bestellung (in â‚¬)</label>
      <input id="revenueGross" type="text" placeholder="z. B. 60" oninput="updateNetto()">
      <label>Netto-Umsatz (automatisch)</label>
      <input id="revenueNet" type="text" readonly style="background:#f0f0f0;">
      <label>Variable Kosten (Produktion + Versand, in â‚¬)</label>
      <input id="variableCost" type="text" placeholder="z. B. 30" oninput="updateNetto()">
      <div id="netProfitInfo" style="font-size:0.85rem;color:#0071e3;margin-top:6px;"></div>
    </div>

    <div class="column">
      <h3>Kampagne</h3>
      <label>Marketingbudget (in â‚¬)</label>
      <input id="marketingBudget" type="text" placeholder="z. B. 1.000">
      <label>ROAS</label>
      <input id="roas" type="text" placeholder="z. B. 3">
      <label>Einmalige Fixkosten (optional, in â‚¬)</label>
      <input id="fixedCost" type="text" placeholder="z. B. 0">
    </div>
  </div>

  <button class="button-main" onclick="calcResult()">Berechnen</button>

  <div class="results" id="results">
    <div class="result-grid">
      <div class="result-card highlight">
        <p><strong>Profit pro Werbe-Euro</strong></p>
        <h1 id="profitPerEuro">â€“</h1>
      </div>
      <div class="result-card">
        <p><strong>Gesamtgewinn / -verlust</strong></p>
        <h1 id="totalProfit">â€“</h1>
      </div>
    </div>
    <p id="warning" class="warning"></p>
  </div>

  <footer>
    <a href="#" id="embedLink"><strong>ðŸ”— Rechner einbetten / teilen</strong></a> â€“ entwickelt von <a href="https://www.purple-noon.de" target="_blank">Purple Noon</a>
  </footer>
</div>

<!-- Overlay -->
<div class="overlay" id="overlay">
  <div class="overlay-content">
    <h3>Einbettungscode:</h3>
    <textarea readonly><iframe src="DEIN-RECHNER-URL" width="100%" height="950" style="border:none;"></iframe></textarea>
    <button class="close-btn" onclick="closeOverlay()">SchlieÃŸen</button>
  </div>
</div>

<script>
function parseNum(v){
  return parseFloat(v.replace(/\./g,"").replace(",",".").replace(/[^\d.-]/g,""))||0;
}

function fmt(num,dec=2){
  return isFinite(num)?num.toLocaleString("de-DE",{minimumFractionDigits:dec,maximumFractionDigits:dec}):"â€“";
}

function formatNumber(num){
  return num.toLocaleString('de-DE', {minimumFractionDigits:2, maximumFractionDigits:2});
}

function updateNetto(){
  const gross = parseNum(document.getElementById("revenueGross").value);
  const variable = parseNum(document.getElementById("variableCost").value);
  const net = gross / 1.19;
  const profit = net - variable;
  document.getElementById("revenueNet").value = gross ? formatNumber(net) + " â‚¬" : "";
  document.getElementById("netProfitInfo").innerText = gross > 0 ? "Netto-Ertrag pro Bestellung: " + formatNumber(profit) + " â‚¬" : "";
}

function calcResult(){
  const gross = parseNum(document.getElementById("revenueGross").value);
  const variable = parseNum(document.getElementById("variableCost").value);
  const roas = parseNum(document.getElementById("roas").value);
  const fixed = parseNum(document.getElementById("fixedCost").value);
  const budget = parseNum(document.getElementById("marketingBudget").value);

  const net = gross / 1.19;
  const profitPerOrder = net - variable;
  
  // âœ… korrekt nach deiner Formel:
  // X = netto - kosten
  // Y = X / brutto
  // umsatz = roas * budget
  // ergebnis = umsatz * Y - budget - fixkosten
  const X = profitPerOrder;
  const Y = X / gross;
  const revenue = roas * budget;
  const totalProfit = revenue * Y - budget - fixed;

  // Ertrag pro Werbe-Euro
  const profitPerEuro = totalProfit / budget;

  document.getElementById("results").style.display = "block";
  document.getElementById("profitPerEuro").innerText = formatNumber(profitPerEuro);
  document.getElementById("totalProfit").innerText = formatNumber(totalProfit) + " â‚¬";
  document.getElementById("warning").innerText = totalProfit < 0 ? "Achtung: Verlust bei dieser Kampagne!" : "";
}

// Eingaben beim Verlassen formatieren
['revenueGross','variableCost','marketingBudget','roas','fixedCost'].forEach(id=>{
  const el=document.getElementById(id);
  el.addEventListener('blur',()=>{ el.value = fmt(parseNum(el.value)).replace(",00",""); });
  el.addEventListener('input',updateNetto);
});

// Overlay
function closeOverlay(){
  document.getElementById("overlay").style.display = "none";
}
document.getElementById("embedLink").addEventListener("click", e => {
  e.preventDefault();
  document.getElementById("overlay").style.display = "flex";
});

// initial
updateNetto();
</script>

</body>
</html>
