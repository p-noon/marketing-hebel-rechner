<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Szenario-Simulator â€“ CR & Kassenzettel</title>
<style>
  body{font-family:-apple-system,BlinkMacSystemFont,"SF Pro Text",Roboto,Arial,sans-serif;background:#f4f4f6;padding:20px}
  .simulator{max-width:950px;margin:40px auto;background:#fff;border-radius:24px;box-shadow:0 8px 20px rgba(0,0,0,0.08);padding:28px;color:#111}
  h2{text-align:center;font-size:1.7rem;margin:0 0 6px}
  .subtitle{text-align:center;color:#666;margin-bottom:22px}
  .input-grid{display:flex;gap:24px;flex-wrap:wrap}
  .column{flex:1;min-width:280px}
  label{display:block;margin-top:12px;margin-bottom:6px;color:#444;font-size:0.95rem}
  input[type="number"],input[readonly]{width:100%;padding:10px;border-radius:10px;border:1px solid #d2d2d7;background:#f9f9f9;box-sizing:border-box;font-size:1rem}
  input[readonly]{background:#f0f0f0}
  .button-main{margin-top:22px;width:100%;background:#0071e3;color:#fff;border:none;border-radius:12px;padding:12px 16px;font-weight:600;cursor:pointer}
  .button-main:hover{background:#0a84ff}
  .results{margin-top:26px;display:none}
  .result-grid{display:grid;grid-template-columns:1fr 1fr;gap:14px}
  .result-card{background:#f6f7fb;padding:14px;border-radius:12px;text-align:center}
  .result-card h1{margin:8px 0;font-size:1.6rem;color:#0071e3}
  .result-card.alt h1{color:#333}
  .helper{font-size:0.88rem;color:#666;margin-top:8px}
  .slider-section{margin-top:28px;padding-top:18px;border-top:1px solid #e6e6ee;display:none}
  input[type="range"]{width:100%;accent-color:#0071e3;cursor:pointer}
  footer{margin-top:20px;text-align:center;color:#999;font-size:13px}
  footer a{color:#0071e3;text-decoration:none}
  .embed-inline{display:inline-block;margin-left:8px;padding:6px 10px;border-radius:8px;background:#eef6ff;color:#0071e3;font-weight:600;cursor:pointer}
  .tiny{font-size:0.85rem;color:#666;margin-top:6px}
</style>
</head>
<body>

<div class="simulator">
  <h2>Szenario-Simulator</h2>
  <p class="subtitle">Simuliere, wie sich Ã„nderungen bei Kassenzettel und Conversion Rate auf Umsatz, Gewinn & ROAS auswirken.</p>

  <div class="input-grid">
    <div class="column">
      <h3>Grunddaten</h3>
      <label>Bruttoumsatz pro Bestellung (EUR)</label>
      <input id="revenueGross" type="number" step="0.01" placeholder="z. B. 60" oninput="updateNet()">

      <label>Nettoumsatz (automatisch)</label>
      <input id="revenueNet" readonly>

      <label>Herstellungskosten pro Bestellung (EUR)</label>
      <input id="productionCost" type="number" step="0.01" placeholder="z. B. 20">

      <label>Verpackung & Versand (EUR)</label>
      <input id="shippingCost" type="number" step="0.01" placeholder="z. B. 5">
    </div>

    <div class="column">
      <h3>Kampagnendaten</h3>
      <label>Conversion Rate (%)</label>
      <input id="conversionRate" type="number" step="0.01" placeholder="z. B. 2">

      <label>ROAS</label>
      <input id="roas" type="number" step="0.1" placeholder="z. B. 3">

      <label>Marketingbudget (EUR)</label>
      <input id="budget" type="number" step="1" placeholder="z. B. 1000">

      <label>Sonstige Fixkosten (EUR)</label>
      <input id="fixedCosts" type="number" step="1" placeholder="z. B. 0">
    </div>
  </div>

  <button class="button-main" onclick="calcBase()">Berechnen (Ist)</button>

  <div class="results" id="results">
    <div class="result-grid" style="margin-top:16px">
      <div class="result-card">
        <p>Umsatz (Brutto)</p>
        <h1 id="totalRevenue">â€“</h1>
        <div class="helper" id="visitorsDisplay"></div>
      </div>
      <div class="result-card alt">
        <p>Gewinn (Ist)</p>
        <h1 id="totalProfit">â€“</h1>
      </div>
    </div>

    <div class="slider-section" id="scenarioSection">
      <h3>Szenario anpassen</h3>
      <p class="tiny">Doppelklick auf Slider = Reset auf Ausgangswert</p>

      <label>Neuer Kassenzettel (Brutto â‚¬)</label>
      <input id="sliderReceipt" type="range" min="0" max="200" step="0.1" value="100" ondblclick="resetSlider('sliderReceipt')" oninput="updateScenario()">
      <div id="receiptValue" class="tiny"></div>

      <label>Neue Conversion Rate (%)</label>
      <input id="sliderCr" type="range" min="0" max="10" step="0.01" value="2" ondblclick="resetSlider('sliderCr')" oninput="updateScenario()">
      <div id="crValue" class="tiny"></div>

      <div class="result-grid" style="margin-top:20px">
        <div class="result-card">
          <p>Neuer Umsatz (Brutto)</p>
          <h1 id="newRevenue">â€“</h1>
        </div>
        <div class="result-card alt">
          <p>Neuer Gewinn</p>
          <h1 id="newProfit">â€“</h1>
          <div class="helper" id="deltaDisplay"></div>
          <div class="helper" id="newRoasDisplay"></div>
        </div>
      </div>
    </div>
  </div>

  <div style="margin-top:18px;text-align:center;">
    <a href="#" id="embedLink" class="embed-inline">ðŸ”— Einbetten</a>
  </div>

  <footer>Tool entwickelt von <a href="https://www.purple-noon.de" target="_blank">Purple Noon</a></footer>
</div>

<!-- Embed Overlay -->
<div id="overlay" style="display:none;position:fixed;inset:0;background:rgba(0,0,0,0.5);align-items:center;justify-content:center;z-index:999">
  <div style="background:#fff;padding:20px;border-radius:12px;max-width:700px;width:92%;box-shadow:0 8px 30px rgba(0,0,0,0.2)">
    <h3>Einbettungscode</h3>
    <textarea readonly id="embedCode" style="width:100%;height:120px;font-family:monospace;border-radius:8px;border:1px solid #ccc;padding:8px"></textarea>
    <div style="display:flex;gap:8px;margin-top:12px">
      <button onclick="closeOverlay()" style="background:#0071e3;color:#fff;padding:8px 12px;border-radius:8px;border:none;cursor:pointer">SchlieÃŸen</button>
      <button onclick="copyEmbed()" style="background:#0a84ff;color:#fff;padding:8px 12px;border-radius:8px;border:none;cursor:pointer">Code kopieren</button>
    </div>
  </div>
</div>

<script>
function fmt(num){if(!isFinite(num))return"â€“";return num.toLocaleString("de-DE",{minimumFractionDigits:2,maximumFractionDigits:2})}
function updateNet(){const g=+revenueGross.value||0;revenueNet.value=g?fmt(g/1.19)+" â‚¬":""}
let base=null;
function calcBase(){
 const gross=+revenueGross.value||0,net=gross/1.19,prod=+productionCost.value||0,ship=+shippingCost.value||0,
 crPct=+conversionRate.value||0,cr=crPct/100,roas=+roas.value||0,budget=+budget.value||0,fixed=+fixedCosts.value||0;
 const totalRevenue=budget*roas,orders=gross?totalRevenue/gross:0,visitors=cr>0?orders/cr:0;
 const profitPerOrder=net-prod-ship,totalProfit=orders*profitPerOrder-budget-fixed;
 base={gross,net,prod,ship,cr,crPct,roas,budget,fixed,totalRevenue,orders,visitors,profitPerOrder,totalProfit};
 totalRevenueEl.textContent=fmt(totalRevenue)+" â‚¬";
 totalProfit.textContent=fmt(totalProfit)+" â‚¬";
 visitorsDisplay.textContent="Berechnete Besucher: "+fmt(visitors);
 results.style.display="block";scenarioSection.style.display="block";
 const recSlider=sliderReceipt,crSlider=sliderCr;
 recSlider.min=gross*0.5;recSlider.max=gross*1.5;recSlider.value=gross;receiptValue.textContent="Aktuell: "+fmt(gross)+" â‚¬";
 crSlider.min=Math.max(0,crPct*0.5);crSlider.max=crPct*1.5;crSlider.value=crPct;crValue.textContent="Aktuell: "+fmt(crPct)+" %";
 updateScenario()
}
function resetSlider(id){const el=document.getElementById(id);if(!base)return;if(id=="sliderReceipt")el.value=base.gross;else el.value=base.crPct;updateScenario()}
function updateScenario(){
 if(!base)return;
 const newGross=+sliderReceipt.value||0,newCrPct=+sliderCr.value||0,newCr=newCrPct/100;
 receiptValue.textContent="Neuer Kassenzettel: "+fmt(newGross)+" â‚¬";
 crValue.textContent="Neue CR: "+fmt(newCrPct)+" %";
 const newProd=base.prod*(newGross/(base.gross||1)),vis=base.visitors,newOrders=vis*newCr,
 newRevenue=newOrders*newGross,newNet=newGross/1.19,profitPer=newNet-newProd-base.ship,
 newProfit=newOrders*profitPer-base.budget-base.fixed,newRoas=base.budget>0?newRevenue/base.budget:0;
 newRevenueEl.textContent=fmt(newRevenue)+" â‚¬";
 newProfitEl.textContent=fmt(newProfit)+" â‚¬";
 deltaDisplay.textContent="Î” Gewinn vs Ist: "+fmt(newProfit-base.totalProfit)+" â‚¬";
 newRoasDisplay.textContent="Neuer ROAS: "+fmt(newRoas);
 newProfitEl.style.color=newProfit<0?"#d70015":"#0071e3"
}
// Embed
embedLink.addEventListener("click",e=>{
 e.preventDefault();
 const origin=location.origin;
 const iframe=`<iframe src="${origin}/szenario-simulator" width="100%" height="900" style="border:none"></iframe>`;
 embedCode.value=iframe;overlay.style.display="flex";
});
function closeOverlay(){overlay.style.display="none"}
function copyEmbed(){embedCode.select();document.execCommand("copy");alert("Embed-Code kopiert")}
updateNet();
</script>
</body>
</html>
