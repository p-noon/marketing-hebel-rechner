<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Marketing-Hebel-Rechner</title>
<style>
body{font-family:-apple-system,BlinkMacSystemFont,"SF Pro Text",Roboto,Arial,sans-serif;background:#f4f4f6;padding:20px}
.simulator{max-width:950px;margin:40px auto;background:#fff;border-radius:24px;box-shadow:0 8px 20px rgba(0,0,0,0.08);padding:28px;color:#111}
h1{text-align:center;font-size:1.8rem;margin:0 0 8px}
.subtitle{text-align:center;color:#666;margin-bottom:22px}
.input-grid{display:flex;gap:24px;flex-wrap:wrap}
.column{flex:1;min-width:280px}
label{display:block;margin-top:12px;margin-bottom:6px;color:#444;font-size:0.95rem}
input[type="text"],input[type="number"],input[readonly]{width:100%;padding:10px;border-radius:10px;border:1px solid #d2d2d7;background:#f9f9f9;box-sizing:border-box;font-size:1rem}
input[readonly]{background:#f0f0f0}
.button-main{margin-top:22px;width:100%;background:#0071e3;color:#fff;border:none;border-radius:12px;padding:12px 16px;font-weight:600;cursor:pointer}
.button-main:hover{background:#0a84ff}
.results{margin-top:26px;display:none}
.result-grid{display:grid;gap:14px}
.result-card{background:#f6f7fb;padding:14px;border-radius:12px;text-align:center}
.result-card h2{margin:8px 0;font-size:1.6rem;color:#0071e3}
.result-card.alt h2{color:#333}
.helper{font-size:0.88rem;color:#666;margin-top:8px}
.delta{font-size:0.85rem;margin-top:4px}
.delta.positive{color:#0a8f00}
.delta.negative{color:#d70015}
.slider-section{margin-top:28px;padding-top:18px;border-top:1px solid #e6e6ee;display:none}
.slider-wrapper{position:relative;margin-top:40px;margin-bottom:40px;text-align:center}
.slider-label-inline{font-weight:600;color:#0071e3;font-size:1rem}
.slider-value{display:inline-block;margin-left:6px;font-weight:700;color:#0071e3;white-space:nowrap;cursor:pointer}
input[type="range"]{width:100%;accent-color:#0071e3;cursor:pointer;margin-top:8px}
.reset-btn{position:absolute;right:4px;top:-4px;cursor:pointer;font-size:18px;color:#0071e3;user-select:none}
footer{margin-top:20px;text-align:center;color:#999;font-size:13px}
footer a{color:#0071e3;text-decoration:none}
footer a:hover{text-decoration:underline}
@media(max-width:600px){
  .result-grid{grid-template-columns:1fr!important;}
  .reset-btn{right:0;top:-18px;}
}
</style>
</head>
<body>

<div class="simulator">
  <h1>Marketing-Hebel-Rechner</h1>
  <p class="subtitle">Simuliere, wie sich Ã„nderungen bei Kassenzettel und Conversion Rate auf Umsatz, Gewinn & ROAS auswirken.</p>

  <div class="input-grid">
    <div class="column">
      <h3>Grunddaten</h3>
      <label>Bruttoumsatz pro Bestellung (EUR)</label>
      <input id="revenueGross" type="text" placeholder="z. B. 60">
      <label>Nettoumsatz (automatisch)</label>
      <input id="revenueNet" type="text" readonly>
      <label>Herstellungskosten pro Bestellung (EUR)</label>
      <input id="productionCost" type="text" placeholder="z. B. 20">
      <label>Verpackung & Versand (EUR)</label>
      <input id="shippingCost" type="text" placeholder="z. B. 5">
    </div>

    <div class="column">
      <h3>Kampagnendaten</h3>
      <label>Conversion Rate (%)</label>
      <input id="conversionRate" type="text" placeholder="z. B. 2">
      <label>ROAS</label>
      <input id="roas" type="text" placeholder="z. B. 3">
      <label>Marketingbudget (EUR)</label>
      <input id="budget" type="text" placeholder="z. B. 1.000">
      <label>Sonstige Fixkosten (EUR)</label>
      <input id="fixedCosts" type="text" placeholder="z. B. 0">
    </div>
  </div>

  <button class="button-main" id="calcButton">Berechnen (Ist)</button>

  <div class="results" id="results">
    <div class="result-grid" style="grid-template-columns:1fr 1fr;gap:14px;margin-top:16px;">
      <div class="result-card">
        <p>Umsatz (Brutto)</p>
        <h2 id="totalRevenue">â€“</h2>
        <div class="helper" id="visitorsDisplay"></div>
      </div>
      <div class="result-card alt">
        <p>Gewinn (Ist)</p>
        <h2 id="totalProfit">â€“</h2>
      </div>
    </div>

    <div class="slider-section" id="scenarioSection">
      <h3>Szenario anpassen</h3>

      <div class="slider-wrapper">
        <span class="slider-label-inline">Neuer Kassenzettel:</span>
        <span id="receiptValue" class="slider-value"></span>
        <span class="reset-btn" id="resetReceipt">âŸ²</span>
        <input id="sliderReceipt" type="range">
      </div>

      <div class="slider-wrapper">
        <span class="slider-label-inline">Neue CR:</span>
        <span id="crValue" class="slider-value"></span>
        <span class="reset-btn" id="resetCr">âŸ²</span>
        <input id="sliderCr" type="range">
      </div>

      <div class="result-grid" style="grid-template-columns:1fr 1fr 1fr;gap:14px;margin-top:20px;">
        <div class="result-card">
          <p>Neuer Umsatz (Brutto)</p>
          <h2 id="newRevenue">â€“</h2>
          <div id="deltaRevenue" class="delta"></div>
        </div>
        <div class="result-card alt">
          <p>Neuer Gewinn</p>
          <h2 id="newProfit">â€“</h2>
          <div id="deltaProfit" class="delta"></div>
        </div>
        <div class="result-card">
          <p>Neuer ROAS</p>
          <h2 id="newRoas">â€“</h2>
          <div id="deltaRoas" class="delta"></div>
        </div>
      </div>
    </div>
  </div>

  <footer>
    <a href="#" id="embedLink"><strong>ðŸ”— Rechner einbetten / teilen</strong></a> â€“ entwickelt von 
    <a href="https://www.purple-noon.de" target="_blank">Purple Noon</a>
  </footer>
</div>

<script>
function parseNum(v){return parseFloat(v.replace(/\./g,"").replace(",",".").replace(/[^\d.-]/g,""))||0;}
function fmt(num,dec=2){return isFinite(num)?num.toLocaleString("de-DE",{minimumFractionDigits:dec,maximumFractionDigits:dec}):"â€“";}
function updateNet(){
  const gross=parseNum(document.getElementById("revenueGross").value);
  document.getElementById("revenueNet").value=gross?fmt(gross/1.19,2):"";
}
let base=null;
function resetScenario(){
  document.getElementById("results").style.display="none";
  document.getElementById("scenarioSection").style.display="none";
  base=null;
}
function calcBase(){
  const gross=parseNum(revenueGross.value);
  const net=gross/1.19;
  const prod=parseNum(productionCost.value);
  const ship=parseNum(shippingCost.value);
  const crPct=parseNum(conversionRate.value);
  const cr=crPct/100;
  const roas=parseNum(document.getElementById("roas").value);
  const budget=parseNum(document.getElementById("budget").value);
  const fixed=parseNum(document.getElementById("fixedCosts").value);
  if(!gross||!roas||!budget){alert("Bitte mindestens Kassenzettel, ROAS und Budget eingeben.");return;}
  const totalRevenue=budget*roas;
  const orders=totalRevenue/gross;
  const visitors=cr>0?orders/cr:0;
  const profitPerOrder=(net-prod-ship);
  const totalProfit=(orders*profitPerOrder)-budget-fixed;
  base={gross,net,prod,ship,cr,crPct,roas,budget,fixed,totalRevenue,orders,visitors,profitPerOrder,totalProfit};
  totalRevenueEl.textContent=fmt(totalRevenue,2)+" â‚¬";
  totalProfitEl.textContent=fmt(totalProfit,2)+" â‚¬";
  visitorsDisplay.textContent="Berechnete Besucher: "+fmt(visitors,0);
  results.style.display="block";
  scenarioSection.style.display="block";

  const kassenzettelMin=Math.max(0,gross-20);
  const kassenzettelMax=gross+20;
  sliderReceipt.min=kassenzettelMin.toFixed(2);
  sliderReceipt.max=kassenzettelMax.toFixed(2);
  sliderReceipt.step="0.01";
  sliderReceipt.value=gross;
  sliderReceipt.dataset.center=gross;

  const crMin=Math.max(0,crPct-4);
  const crMax=crPct+4;
  sliderCr.min=crMin.toFixed(2);
  sliderCr.max=crMax.toFixed(2);
  sliderCr.step="0.01";
  sliderCr.value=crPct;
  sliderCr.dataset.center=crPct;

  receiptValue.textContent=fmt(gross,2);
  crValue.textContent=fmt(crPct,2);
  updateScenario();
}
function updateScenario(){
  if(!base)return;
  const newGross=parseFloat(sliderReceipt.value);
  const newCrPct=parseFloat(sliderCr.value);
  const newCr=newCrPct/100;
  receiptValue.textContent=fmt(newGross,2);
  crValue.textContent=fmt(newCrPct,2);
  const newProd=base.prod*(newGross/(base.gross||1));
  const newOrders=base.visitors*newCr;
  const newRevenue=newOrders*newGross;
  const newNet=newGross/1.19;
  const profitPer=newNet-newProd-base.ship;
  const newProfit=(newOrders*profitPer)-base.budget-base.fixed;
  const newRoas=base.budget>0?newRevenue/base.budget:0;
  newRevenueEl.textContent=fmt(newRevenue,2)+" â‚¬";
  newProfitEl.textContent=fmt(newProfit,2)+" â‚¬";
  newRoasEl.textContent=fmt(newRoas,2);
  const delta=(v,b)=>((v-b>=0?"+":"")+fmt(v-b,2));
  deltaRevenue.textContent=delta(newRevenue,base.totalRevenue)+" â‚¬";
  deltaProfit.textContent=delta(newProfit,base.totalProfit)+" â‚¬";
  deltaRoas.textContent=delta(newRoas,base.roas);
  deltaRevenue.className="delta "+(newRevenue>=base.totalRevenue?"positive":"negative");
  deltaProfit.className="delta "+(newProfit>=base.totalProfit?"positive":"negative");
  deltaRoas.className="delta "+(newRoas>=base.roas?"positive":"negative");
  newProfitEl.style.color=newProfit<0?"#d70015":"#0071e3";
}
function makeEditable(span,slider){
  span.addEventListener("click",()=>{
    const current=parseNum(span.textContent);
    const input=document.createElement("input");
    input.type="text";input.value=fmt(current,2);
    Object.assign(input.style,{width:"4em",textAlign:"right",border:"none",background:"transparent",color:"#0071e3",fontWeight:"700",outline:"none",fontFamily:"inherit"});
    span.replaceWith(input);
    input.focus();input.select();
    const commit=()=>{let val=parseNum(input.value);if(!isFinite(val)) val=current;input.replaceWith(span);slider.value=val;updateScenario();};
    input.addEventListener("blur",commit);
    input.addEventListener("keydown",e=>{if(e.key==="Enter")commit();if(e.key==="Escape")input.replaceWith(span);});
  });
}
const revenueGross=document.getElementById("revenueGross");
const revenueNet=document.getElementById("revenueNet");
const productionCost=document.getElementById("productionCost");
const shippingCost=document.getElementById("shippingCost");
const conversionRate=document.getElementById("conversionRate");
const totalRevenueEl=document.getElementById("totalRevenue");
const totalProfitEl=document.getElementById("totalProfit");
const visitorsDisplay=document.getElementById("visitorsDisplay");
const sliderReceipt=document.getElementById("sliderReceipt");
const sliderCr=document.getElementById("sliderCr");
const receiptValue=document.getElementById("receiptValue");
const crValue=document.getElementById("crValue");
const results=document.getElementById("results");
const scenarioSection=document.getElementById("scenarioSection");
const newRevenueEl=document.getElementById("newRevenue");
const newProfitEl=document.getElementById("newProfit");
const newRoasEl=document.getElementById("newRoas");
const deltaRevenue=document.getElementById("deltaRevenue");
const deltaProfit=document.getElementById("deltaProfit");
const deltaRoas=document.getElementById("deltaRoas");
document.querySelectorAll('#revenueGross,#productionCost,#shippingCost,#conversionRate,#roas,#budget,#fixedCosts')
  .forEach(el=>{
    el.addEventListener('input',resetScenario);
    el.addEventListener('blur',()=>{el.value=fmt(parseNum(el.value),2).replace(",00","");});
  });
document.getElementById("calcButton").addEventListener("click",calcBase);
sliderReceipt.addEventListener("input",updateScenario);
sliderCr.addEventListener("input",updateScenario);
makeEditable(receiptValue,sliderReceipt);
makeEditable(crValue,sliderCr);
document.getElementById("resetReceipt").addEventListener("click",()=>{if(sliderReceipt.dataset.center){sliderReceipt.value=sliderReceipt.dataset.center;updateScenario();}});
document.getElementById("resetCr").addEventListener("click",()=>{if(sliderCr.dataset.center){sliderCr.value=sliderCr.dataset.center;updateScenario();}});
revenueGross.addEventListener("input",updateNet);
</script>
</body>
</html>
